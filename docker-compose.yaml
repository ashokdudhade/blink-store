# Blink-Store TCP server with resource limits.
# Usage: docker compose up -d   then connect to host:8765

services:
  blink-store:
    build: .
    image: blink-store:latest
    command: ["serve", "--tcp", "0.0.0.0:8765", "--memory-limit", "10485760", "--retention-minutes", "60"]
    ports:
      - "8765:8765"
    # Optional: persist logs
    # volumes:
    #   - blink-logs:/logs
    # command: ["serve", "--tcp", "0.0.0.0:8765", "--log-dir", "/logs", "--memory-limit", "10485760", "--retention-minutes", "60"]
    deploy:
      resources:
        limits:
          memory: 32M
        reservations:
          memory: 8M
    # Optional: CPU pinning (example)
    # cpuset: "0-1"

# volumes:
#   blink-logs:
